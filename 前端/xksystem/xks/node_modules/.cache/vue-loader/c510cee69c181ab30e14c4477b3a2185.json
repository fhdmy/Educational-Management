{"remainingRequest":"/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/src/components/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/src/components/Login.vue","mtime":1592143580789},{"path":"/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jiang/Desktop/数据库/第二学期/选课系统/前端/xksystem/xks/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiAoKSA9PiAoewogICAgYWNjb3VudDogIiIsCiAgICBwd2Q6ICIiLAogICAgYWNjb3VudF9mYWlsZWQ6IGZhbHNlLAogICAgeTogInRvcCIsCiAgICB0aW1lb3V0OiAyMDAwLAogICAgdXNlcl90eXBlX2FycmF5OiBbIuWtpueUnyIsICLogIHluIgiLCAi566h55CG5ZGYIl0sCiAgICB1c2VyX3R5cGU6ICLlrabnlJ8iCiAgfSksCiAgY3JlYXRlZCgpIHsKICAgIGlmICgKICAgICAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImlkIikgIT0gbnVsbCAmJgogICAgICBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGFzc3dvcmQiKSAhPSBudWxsCiAgICApIHsKICAgICAgdGhpcy5hY2NvdW50ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImlkIik7CiAgICAgIHRoaXMucHdkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhc3N3b3JkIik7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2dpbigpIHsKICAgICAgaWYgKHRoaXMudXNlcl90eXBlID09ICLlrabnlJ8iKSB7CiAgICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgICBtZXRob2Q6ICJwb3N0IiwKICAgICAgICAgIHVybDogIi9hcGkvc3R1ZGVudC9zdHVkZW50cy9sb2dpbi8iLAogICAgICAgICAgZGF0YTogewogICAgICAgICAgICBzaWQ6IHRoaXMuYWNjb3VudCwKICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuQmFzZTY0LmVuY29kZSh0aGlzLnB3ZCkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgLy/nmbvlvZXmiJDlip8KICAgICAgICAgICAgaWYgKHJlcy5kYXRhKSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImlkIiwgdGhpcy5hY2NvdW50KTsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgicGFzc3dvcmQiLCB0aGlzLnB3ZCk7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInRva2VuIiwgcmVzLmRhdGEudG9rZW4pOwogICAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dCgpOwogICAgICAgICAgICAgIHRoaXMuJGVtaXQoImxvZ2luIiwgcmVzLmRhdGEudG9rZW4pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuYWNjb3VudF9mYWlsZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgZWxzZSBpZih0aGlzLnVzZXJfdHlwZSA9PSAi6ICB5biIIil7CiAgICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgICBtZXRob2Q6ICJwb3N0IiwKICAgICAgICAgIHVybDogIi9hcGkvdGVhY2hlci90ZWFjaGVycy9sb2dpbi8iLAogICAgICAgICAgZGF0YTogewogICAgICAgICAgICB0aWQ6IHRoaXMuYWNjb3VudCwKICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuQmFzZTY0LmVuY29kZSh0aGlzLnB3ZCkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgLy/nmbvlvZXmiJDlip8KICAgICAgICAgICAgaWYgKHJlcy5kYXRhKSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImlkIiwgdGhpcy5hY2NvdW50KTsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgicGFzc3dvcmQiLCB0aGlzLnB3ZCk7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInRva2VuIiwgcmVzLmRhdGEudG9rZW4pOwogICAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dCgpOwogICAgICAgICAgICAgIHRoaXMuJGVtaXQoImxvZ2luIiwgcmVzLmRhdGEudG9rZW4pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuYWNjb3VudF9mYWlsZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgZWxzZSBpZih0aGlzLnVzZXJfdHlwZSA9PSAi566h55CG5ZGYIil7CiAgICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgICBtZXRob2Q6ICJwb3N0IiwKICAgICAgICAgIHVybDogIi9hcGkvc3lzYWRtaW4vc3lzdGVtYWRtaW5zL2xvZ2luLyIsCiAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgIGFkbWluaWQ6IHRoaXMuYWNjb3VudCwKICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuQmFzZTY0LmVuY29kZSh0aGlzLnB3ZCkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgLy/nmbvlvZXmiJDlip8KICAgICAgICAgICAgaWYgKHJlcy5kYXRhKSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImlkIiwgdGhpcy5hY2NvdW50KTsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgicGFzc3dvcmQiLCB0aGlzLnB3ZCk7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInRva2VuIiwgcmVzLmRhdGEudG9rZW4pOwogICAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dCgpOwogICAgICAgICAgICAgIHRoaXMuJGVtaXQoImxvZ2luIiwgcmVzLmRhdGEudG9rZW4pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuYWNjb3VudF9mYWlsZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VfdXNlcl90eXBlKGUpIHsKICAgICAgdGhpcy51c2VyX3R5cGUgPSBlOwogICAgfSwKICAgIGNhbmNlbCgpIHsKICAgICAgdGhpcy5jbGVhcklucHV0KCk7CiAgICAgIHRoaXMuJGVtaXQoImNhbmNlbCIpOwogICAgfSwKICAgIGNsZWFySW5wdXQoKSB7CiAgICAgIHRoaXMuYWNjb3VudCA9ICIiOwogICAgICB0aGlzLnB3ZCA9ICIiOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-container>\n    <v-snackbar\n      v-model=\"account_failed\"\n      multi-line=\"multi-line\"\n      :top=\"y === 'top'\"\n      :timeout=\"timeout\"\n    >\n      账号或密码错误！\n      <v-btn color=\"red\" text @click=\"account_failed = false\">关闭</v-btn>\n    </v-snackbar>\n    <v-card class=\"elevation-12\">\n      <v-toolbar color=\"indigo\" dark flat>\n        <v-toolbar-title>选课系统</v-toolbar-title>\n        <v-spacer/>\n      </v-toolbar>\n      <v-card-text>\n        <v-form>\n          <v-text-field label=\"账号\" name=\"account\" type=\"number\" v-model=\"account\"/>\n          <v-text-field id=\"password\" label=\"密码\" name=\"password\" type=\"password\" v-model=\"pwd\"/>\n          <v-select\n            :items=\"user_type_array\"\n            label=\"用户类型\"\n            :value=\"user_type\"\n            @change=\"change_user_type($event)\"\n          ></v-select>\n        </v-form>\n      </v-card-text>\n      <v-card-actions>\n        <v-spacer/>\n        <v-btn color=\"indigo\" style=\"color:white;margin-right:20px;\" @click=\"cancel()\">取消</v-btn>\n        <v-btn color=\"indigo\" style=\"color:white;\" @click=\"login()\">登录</v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-container>\n</template>\n\n<script>\nexport default {\n  data: () => ({\n    account: \"\",\n    pwd: \"\",\n    account_failed: false,\n    y: \"top\",\n    timeout: 2000,\n    user_type_array: [\"学生\", \"老师\", \"管理员\"],\n    user_type: \"学生\"\n  }),\n  created() {\n    if (\n      localStorage.getItem(\"id\") != null &&\n      localStorage.getItem(\"password\") != null\n    ) {\n      this.account = localStorage.getItem(\"id\");\n      this.pwd = localStorage.getItem(\"password\");\n    }\n  },\n  methods: {\n    login() {\n      if (this.user_type == \"学生\") {\n        this.$http({\n          method: \"post\",\n          url: \"/api/student/students/login/\",\n          data: {\n            sid: this.account,\n            password: this.Base64.encode(this.pwd)\n          }\n        })\n          .then(res => {\n            //登录成功\n            if (res.data) {\n              localStorage.setItem(\"id\", this.account);\n              localStorage.setItem(\"password\", this.pwd);\n              localStorage.setItem(\"token\", res.data.token);\n              this.clearInput();\n              this.$emit(\"login\", res.data.token);\n            } else {\n              this.account_failed = true;\n            }\n          })\n          .catch(error => {\n            console.log(error.response);\n          });\n      }\n      else if(this.user_type == \"老师\"){\n        this.$http({\n          method: \"post\",\n          url: \"/api/teacher/teachers/login/\",\n          data: {\n            tid: this.account,\n            password: this.Base64.encode(this.pwd)\n          }\n        })\n          .then(res => {\n            //登录成功\n            if (res.data) {\n              localStorage.setItem(\"id\", this.account);\n              localStorage.setItem(\"password\", this.pwd);\n              localStorage.setItem(\"token\", res.data.token);\n              this.clearInput();\n              this.$emit(\"login\", res.data.token);\n            } else {\n              this.account_failed = true;\n            }\n          })\n          .catch(error => {\n            console.log(error.response);\n          });\n      }\n      else if(this.user_type == \"管理员\"){\n        this.$http({\n          method: \"post\",\n          url: \"/api/sysadmin/systemadmins/login/\",\n          data: {\n            adminid: this.account,\n            password: this.Base64.encode(this.pwd)\n          }\n        })\n          .then(res => {\n            //登录成功\n            if (res.data) {\n              localStorage.setItem(\"id\", this.account);\n              localStorage.setItem(\"password\", this.pwd);\n              localStorage.setItem(\"token\", res.data.token);\n              this.clearInput();\n              this.$emit(\"login\", res.data.token);\n            } else {\n              this.account_failed = true;\n            }\n          })\n          .catch(error => {\n            console.log(error.response);\n          });\n      }\n    },\n    change_user_type(e) {\n      this.user_type = e;\n    },\n    cancel() {\n      this.clearInput();\n      this.$emit(\"cancel\");\n    },\n    clearInput() {\n      this.account = \"\";\n      this.pwd = \"\";\n    }\n  }\n};\n</script>"]}]}